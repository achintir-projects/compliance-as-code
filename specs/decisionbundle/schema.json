{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://glassbox.ai/schemas/decisionbundle/v1.0.json",
  "title": "GlassBox AI DecisionBundle",
  "description": "A standardized bundle for compliance decisions, rules, and evidence",
  "type": "object",
  "required": [
    "version",
    "metadata",
    "rules",
    "decisions"
  ],
  "properties": {
    "version": {
      "type": "string",
      "enum": ["1.0"],
      "description": "GlassBox AI DecisionBundle specification version"
    },
    "metadata": {
      "type": "object",
      "required": [
        "id",
        "name",
        "description",
        "created",
        "jurisdiction",
        "domain"
      ],
      "properties": {
        "id": {
          "type": "string",
          "format": "uuid",
          "description": "Unique identifier for the DecisionBundle"
        },
        "name": {
          "type": "string",
          "description": "Human-readable name of the DecisionBundle"
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the DecisionBundle purpose"
        },
        "created": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when the DecisionBundle was created"
        },
        "modified": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when the DecisionBundle was last modified"
        },
        "author": {
          "type": "string",
          "description": "Author or organization that created the DecisionBundle"
        },
        "jurisdiction": {
          "type": "string",
          "description": "Jurisdiction or regulatory framework (e.g., 'GDPR', 'CCPA', 'SOX')"
        },
        "domain": {
          "type": "string",
          "enum": ["finance", "health", "esg", "general"],
          "description": "Business domain the DecisionBundle applies to"
        },
        "tags": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "Tags for categorization and search"
        },
        "signature": {
          "type": "object",
          "properties": {
            "algorithm": {
              "type": "string",
              "enum": ["ES256", "RS256", "HS256"],
              "description": "Signature algorithm used"
            },
            "publicKey": {
              "type": "string",
              "description": "Public key for verification"
            },
            "value": {
              "type": "string",
              "description": "Digital signature value"
            }
          },
          "description": "Digital signature for integrity verification"
        }
      }
    },
    "rules": {
      "type": "array",
      "items": {
        "type": "object",
        "required": [
          "id",
          "name",
          "type",
          "definition"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for the rule"
          },
          "name": {
            "type": "string",
            "description": "Human-readable name of the rule"
          },
          "description": {
            "type": "string",
            "description": "Detailed description of the rule"
          },
          "type": {
            "type": "string",
            "enum": ["dsl", "expression", "decision_table", "decision_tree"],
            "description": "Type of rule definition"
          },
          "definition": {
            "type": "object",
            "description": "Rule definition content"
          },
          "severity": {
            "type": "string",
            "enum": ["low", "medium", "high", "critical"],
            "description": "Severity level of the rule"
          },
          "category": {
            "type": "string",
            "description": "Category of the rule (e.g., 'data_protection', 'access_control')"
          },
          "references": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "type": {
                  "type": "string",
                  "enum": ["regulation", "standard", "policy", "guideline"]
                },
                "id": {
                  "type": "string",
                  "description": "Reference identifier"
                },
                "title": {
                  "type": "string",
                  "description": "Reference title"
                },
                "url": {
                  "type": "string",
                  "format": "uri",
                  "description": "URL to the reference document"
                }
              }
            },
            "description": "Regulatory or policy references"
          }
        }
      },
      "description": "Array of compliance rules"
    },
    "decisions": {
      "type": "array",
      "items": {
        "type": "object",
        "required": [
          "id",
          "ruleId",
          "input",
          "output",
          "timestamp"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for the decision"
          },
          "ruleId": {
            "type": "string",
            "description": "Reference to the rule that was evaluated"
          },
          "input": {
            "type": "object",
            "description": "Input data used for the decision"
          },
          "output": {
            "type": "object",
            "properties": {
              "result": {
                "type": "boolean",
                "description": "Decision result (pass/fail)"
              },
              "confidence": {
                "type": "number",
                "minimum": 0,
                "maximum": 1,
                "description": "Confidence score of the decision"
              },
              "reason": {
                "type": "string",
                "description": "Explanation of the decision"
              },
              "evidence": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "type": {
                      "type": "string",
                      "enum": ["log", "document", "metric", "user_input"]
                    },
                    "id": {
                      "type": "string",
                      "description": "Evidence identifier"
                    },
                    "content": {
                      "type": "string",
                      "description": "Evidence content or reference"
                    },
                    "timestamp": {
                      "type": "string",
                      "format": "date-time",
                      "description": "Evidence timestamp"
                    }
                  }
                },
                "description": "Supporting evidence for the decision"
              }
            },
            "description": "Decision output and metadata"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp when the decision was made"
          },
          "executor": {
            "type": "string",
            "description": "System or user that executed the decision"
          },
          "context": {
            "type": "object",
            "description": "Additional context information"
          }
        }
      },
      "description": "Array of compliance decisions"
    },
    "evidence": {
      "type": "array",
      "items": {
        "type": "object",
        "required": [
          "id",
          "type",
          "content",
          "timestamp"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for the evidence"
          },
          "type": {
            "type": "string",
            "enum": ["log", "document", "metric", "user_input", "system_event"],
            "description": "Type of evidence"
          },
          "content": {
            "type": "object",
            "description": "Evidence content"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "Evidence timestamp"
          },
          "source": {
            "type": "string",
            "description": "Source of the evidence"
          },
          "hash": {
            "type": "string",
            "description": "Cryptographic hash for integrity verification"
          }
        }
      },
      "description": "Array of supporting evidence"
    },
    "audit": {
      "type": "object",
      "properties": {
        "created": {
          "type": "string",
          "format": "date-time",
          "description": "Audit creation timestamp"
        },
        "modified": {
          "type": "string",
          "format": "date-time",
          "description": "Audit modification timestamp"
        },
        "version": {
          "type": "string",
          "description": "Audit version"
        },
        "checksum": {
          "type": "string",
          "description": "Checksum for the entire bundle"
        },
        "trail": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "timestamp": {
                "type": "string",
                "format": "date-time"
              },
              "action": {
                "type": "string"
              },
              "user": {
                "type": "string"
              },
              "details": {
                "type": "object"
              }
            }
          },
          "description": "Audit trail of changes"
        }
      },
      "description": "Audit information for the DecisionBundle"
    }
  }
}